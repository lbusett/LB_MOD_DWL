<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>MODIStsp main function — MODIStsp • MODIStsp</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="MODIStsp main function — MODIStsp"><meta property="og:description" content="Main function for the MODIS Time Series Processing Tool
(MODIStsp)"><meta property="og:image" content="http://docs.ropensci.org/MODIStsp/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-84499524-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84499524-2');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MODIStsp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/interactive_execution.html">Interactive Execution - the MODIStsp GUI</a>
    </li>
    <li>
      <a href="../articles/noninteractive_execution.html">Non-Interactive Execution from within R</a>
    </li>
    <li>
      <a href="../articles/standalone_execution.html">Standalone Execution and Scheduled Processing</a>
    </li>
    <li>
      <a href="../articles/output.html">Outputs Format and Naming Conventions</a>
    </li>
    <li>
      <a href="../articles/analyze.html">Accessing and Analyzing Processed Data from R</a>
    </li>
    <li>
      <a href="../articles/products_list.html">Supported MODIS Products</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/faq.html">
    <span class="fa fa-question-circle-o"></span>
     
    faq
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/ropensci/MODIStsp/" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
<li>
  <a href="../articles/lorenzo.html">
    <span class="fa fa-cross"></span>
     
    dedication
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MODIStsp main function</h1>
    <small class="dont-index">Source: <a href="https://github.com/ropensci/MODIStsp/blob/HEAD/R/MODIStsp.R" class="external-link"><code>R/MODIStsp.R</code></a></small>
    <div class="hidden name"><code>MODIStsp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Main function for the MODIS Time Series Processing Tool
(MODIStsp)</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MODIStsp</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  gui <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  out_folder <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  out_folder_mod <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  opts_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  selprod <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prod_version <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bandsel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quality_bandsel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indexes_bandsel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sensor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  download_server <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  downloader <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  user <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  password <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  download_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spatmeth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bbox <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spafile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  out_projsel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_proj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  out_res_sel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  out_res <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resampling <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reprocess <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  delete_hdf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nodata_change <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale_val <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ts_format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  out_format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  compress <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  test <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_retries <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>...</dt>
<dd><p>not used for values, forces later arguments to bind by name</p></dd>


<dt>gui</dt>
<dd><p><code>logical</code> if TRUE: the GUI is opened before processing. If FALSE:
processing parameters are retrieved from the provided <code>opts_file</code>
argument), Default: TRUE</p></dd>


<dt>out_folder</dt>
<dd><p><code>character</code> Main output folder, default: NULL.</p></dd>


<dt>out_folder_mod</dt>
<dd><p><code>character</code> Output folder for original HDF storage.
If <code>"$tempdir"</code> (default), a temporary directory is used.</p></dd>


<dt>opts_file</dt>
<dd><p><code>character</code> full path to a JSON file
containing MODIStsp processing options saved from the GUI, Default: NULL</p></dd>


<dt>selprod</dt>
<dd><p><code>character</code> Name of selected MODIS product (e.g.,
Vegetation Indexes_16Days_250m (M*D13Q1)). You can get
a list of available product names using function <code>MODIStsp_get_prodnames</code>,
Default: NULL</p></dd>


<dt>prod_version</dt>
<dd><p>Version of the selected MODIS product.
Currently versions <code>"006"</code> and/or <code>"061"</code> can be chosen.
Default value is <code>"006"</code> until decommission of this version will be
announced by USGS.
Products with version <code>"061</code> are experimental: in case users would encounter
an error in the encoding of bands or quality flags they are encouraged
to report it by opening a new issue on GitHub at
<a href="https://github.com/ropensci/MODIStsp/issues" class="external-link">https://github.com/ropensci/MODIStsp/issues</a>.</p></dd>


<dt>bandsel</dt>
<dd><p><code>character array</code> Original MODIS layers to be processed.
You can get a list of available layers for a given product
using function <code>MODIStsp_get_prodlayers</code> (e.g., MODIStsp_get_prodlayers("M*D13Q1")$bandnames),
Default: NULL</p></dd>


<dt>quality_bandsel</dt>
<dd><p><code>character array</code> Quality Indicators to be computed starting from
bit fields of original MODIS layers. You can get a list of available quality layers for a given product
using function <code>MODIStsp_get_prodlayers</code> (e.g., MODIStsp_get_prodlayers("M*D13Q1")$quality_bandnames),
Default: NULL</p></dd>


<dt>indexes_bandsel</dt>
<dd><p><code>character array</code>Spectral Indexes to be computed starting from reflectance bands.
You can get a list of available quality layers for a given product
using function <code>MODIStsp_get_prodlayers</code> (e.g., MODIStsp_get_prodlayers("M*D13Q1")$indexes_bandnames),
Default: NULL</p></dd>


<dt>sensor</dt>
<dd><p><code>character ["Terra"| "Aqua" | "Both"]</code> MODIS platform to be considered.
(Ignored for MCD* products). Default: "Both"</p></dd>


<dt>download_server</dt>
<dd><p><code>character ["http" | "offline"]</code> service to be used for
download. Default: "http"</p></dd>


<dt>downloader</dt>
<dd><p>download_server <code>character ["http" | "aria2"]</code> downloader to be used,
Default: "http"</p></dd>


<dt>user</dt>
<dd><p><code>character</code> Username for NASA http server.
(<a href="https://urs.earthdata.nasa.gov/home" class="external-link">urs.earthdata.nasa.gov/home</a>).</p></dd>


<dt>password</dt>
<dd><p><code>character</code> Password for NASA http server
(<a href="https://urs.earthdata.nasa.gov/home" class="external-link">urs.earthdata.nasa.gov/home</a>).</p></dd>


<dt>download_range</dt>
<dd><p><code>character ["Full" | "Seasonal"]</code> If "full", all the
available images between the starting and the ending dates are downloaded;
If "seasonal", only the images included in the season are downloaded
(e.g: if the starting date is 2005-12-01 and the ending is 2010-02-31, only
the images of December, January and February from 2005 to 2010 - excluding
2005-01, 2005-02 and 2010-12 - are downloaded), Default: Full</p></dd>


<dt>start_date</dt>
<dd><p><code>character</code> Start date for images download and preprocessing
(yyyy.mm.dd), Default: NULL</p></dd>


<dt>end_date</dt>
<dd><p><code>character</code> End date for images download and preprocessing
(yyyy.mm.dd), Default: NULL</p></dd>


<dt>spatmeth</dt>
<dd><p><code>character ["tiles" | "bbox" | "file"]</code>, indicates how the processing
extent is retrieves. if "tiles", use the specified tiles (start_x....).
If "file", retrieve extent from spatial file specifies in <code>spafile</code>. If
"bbox", use the specified bounding box, Default: "tiles"</p></dd>


<dt>start_x</dt>
<dd><p><code>integer [0-35]</code> Start MODIS horizontal tile defining spatial extent.
Ignored if spatmeth != "tiles", Default: 18</p></dd>


<dt>end_x</dt>
<dd><p><code>integer [0-35]</code> End MODIS horizontal tile defining spatial extent.
Ignored if spatmeth != "tiles", Default: 18</p></dd>


<dt>start_y</dt>
<dd><p><code>integer [0-17]</code> Start MODIS vertical tile defining spatial extent.
Ignored if spatmeth != "tiles", Default: 4</p></dd>


<dt>end_y</dt>
<dd><p><code>integer [0-17]</code> End MODIS vertical tile defining spatial extent.
Ignored if spatmeth != "tiles", Default: 4</p></dd>


<dt>bbox</dt>
<dd><p><code>numeric(4)</code> Output bounding box (xmin, ymin, xmax, ymax) in
out_proj coordinate system. Ignored if spatmeth == "tiles", Default: NULL</p></dd>


<dt>spafile</dt>
<dd><p><code>character</code> (optional) full path of a spatial file
to use to derive the processing extent. If not NULL, the processing options
which define the extent, the selected tiles and the "Full Tile / Custom"
in the JSON options file are overwritten and new files are created on the
extent of the provided spatial file. Ignored if spatmeth != "file", Default: NULL</p></dd>


<dt>out_projsel</dt>
<dd><p><code>character ["Native", "User Defined</code>] If "Native", the
outputs keep the original resolution of MODIS HDF images. Otherwise, the value
set in "out_res" is used, Default:Native</p></dd>


<dt>output_proj</dt>
<dd><p><code>character</code> either equal to "MODIS Sinusoidal",
or to the code of a valid EPSG or to a WKT projection string.
Ignored if outproj_sel == "Native", Default: NULL</p></dd>


<dt>out_res_sel</dt>
<dd><p><code>character ["Native", "User Defined</code>]. If "Native", the
outputs keep the original resolution of MODIS HDF images. Otherwise, the value
set in "out_res" is used.</p></dd>


<dt>out_res</dt>
<dd><p><code>float</code> Output resolution (in output projection measurement
unit). Ignored if out_res_sel == "Native".</p></dd>


<dt>resampling</dt>
<dd><p><code>character ["near" | "bilinear" | "cubic" | "cubicspline", |lanczos"|, "average"|, "mode", |"max"|, |"min"|, |"q1"|, |"q3"|, |"sum"|]</code>
Resampling method to be used by <code>gdalwarp</code>.</p></dd>


<dt>reprocess</dt>
<dd><p><code>logical</code> If TRUE, reprocess data for already existing dates.</p></dd>


<dt>delete_hdf</dt>
<dd><p><code>logical</code> If TRUE, delete downloaded HDF files after completion.</p></dd>


<dt>nodata_change</dt>
<dd><p><code>logical</code> if TRUE, NoData values are set to the max value
of the datatype of the layer on the MODIStsp output rasters. NOTE: If multiple
nodata values are reported for a layer, all are reset to the new value.</p></dd>


<dt>scale_val</dt>
<dd><p><code>logical</code> If TRUE,  scale and offset are applied to
original MODIS layers, and Spectral Indexes are saved as floating point. If
FALSE, no rescaling is done and Spectral Indexes are saved as integer, with a
10000 scaling factor.</p></dd>


<dt>ts_format</dt>
<dd><p><code>character array including ["R RasterStack" | "ENVI Meta Files" | "GDAL VRT" | "ENVI and GDAL"]</code> Selected virtual time series format.</p></dd>


<dt>out_format</dt>
<dd><p><code>character ["ENVI" | "GTiff"]</code> Desired output format.</p></dd>


<dt>compress</dt>
<dd><p><code>character ["None" | "PACKBITS" | "LZW" | "DEFLATE"]</code>
Compression method for GTiff outputs (Ignored if <code>out_format == ENVI</code>)</p></dd>


<dt>test</dt>
<dd><p><code>integer | character  (e.g., "01a")</code> if set, MODIStsp is executed in
"test mode", using a preset Options File instead than opening the GUI or accepting the
<code>opts_file</code> parameter. This allows both to check correct installation on
user's machines, and to implement unit testing.</p></dd>


<dt>n_retries</dt>
<dd><p><code>numeric</code> maximum number of retries on download functions.
In case any download function fails more than <code>n_retries</code> times consecutively,
MODIStsp_process will abort, Default: 20</p></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> If FALSE, suppress processing messages,
Default: TRUE</p></dd>


<dt>parallel</dt>
<dd><p><code>logical</code> If TRUE (default), the function is run using parallel
processing, to speed-up the computation for large rasters (with a maximum
of 8 cores).
The number of cores is automatically determined; specifying it is also
possible (e.g. <code>parallel = 4</code>). In this case, more than 8 cores can be
specified. If FALSE (default), single core processing is used.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function is used to:</p><ul><li><p>initialize the processing (folder names, packages, etc.);</p></li>
<li><p>launch the GUI (<code><a href="MODIStsp_GUI.html">MODIStsp_GUI()</a></code>) on interactive
execution, or load an options file to set processing arguments and/or
retrieve CLI inputs and run processing on non-interactive execution;</p></li>
<li><p>launch the routines for downloading and processing the requested datasets.
(<code><a href="MODIStsp_process.html">MODIStsp_process()</a></code>)</p></li>
<li><p>launching the function with GUI = FALSE and without specifying a opts_file
initializes arguments with default values. This allows making a test run.</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p>License: GPL 3.0</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="MODIStsp_GUI.html">MODIStsp_GUI()</a></code>, <code><a href="MODIStsp_process.html">MODIStsp_process()</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Lorenzo Busetto, phD (2014-2017)</p>
<p>Luigi Ranghetti, phD (2015-2017)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#' # - Running the tool using the GUI</span></span></span>
<span class="r-in"><span><span class="co"># Running the tool without any option will start the GUI with the default or</span></span></span>
<span class="r-in"><span><span class="co"># last used settings, in interactive mode (i.e., with gui = TRUE).</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">MODIStsp</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#' # - Running the tool specifying processing arguments in the call</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># **NOTE** Output files of examples are saved to file.path(tempdir(), "MODIStsp").</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Here we process layers __NDVI__ and __EVI__ and quality indicator __usefulness__</span></span></span>
<span class="r-in"><span><span class="co"># of product __M*D13Q1__, considering both Terra and Aqua platforms, for dates</span></span></span>
<span class="r-in"><span><span class="co"># comprised between 2020-06-01 and 2020-06-15 and saves output to R tempdir</span></span></span>
<span class="r-in"><span><span class="co"># --&gt; See name and available layers for product M*D13Q1.</span></span></span>
<span class="r-in"><span><span class="co"># Note that this example (as well as the following ones) is run in single</span></span></span>
<span class="r-in"><span><span class="co"># core to follow CRAN policies, by setting parallel = FALSE.</span></span></span>
<span class="r-in"><span><span class="co"># Users can exploit multicore functionalities skipping to set this argument.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The following check is performed in order not to provide errors</span></span></span>
<span class="r-in"><span><span class="co"># running the examples if HDF4 is not supported.</span></span></span>
<span class="r-in"><span><span class="va">is_hdf4_supported</span> <span class="op">&lt;-</span> <span class="st">"HDF4"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_drivers.html" class="external-link">st_drivers</a></span><span class="op">(</span><span class="st">"raster"</span><span class="op">)</span><span class="op">$</span><span class="va">name</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="MODIStsp_get_prodlayers.html">MODIStsp_get_prodlayers</a></span><span class="op">(</span><span class="st">"M*D13A2"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $prodname</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Vegetation_Indexes_16Days_1Km (M*D13A2)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bandnames</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "NDVI"     "EVI"      "VI_QA"    "b1_Red"   "b2_NIR"   "b3_Blue" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "b7_SWIR"  "View_Zen" "Sun_Zen"  "Rel_Az"   "DOY"      "Rely"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bandfullnames</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "16 day NDVI average"                "16 day EVI average"                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "VI quality indicators"              "Surface Reflectance Band 1"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "Surface Reflectance Band 2"         "Surface Reflectance Band 3"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "Surface Reflectance Band 7"         "View zenith angle of VI pixel"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "Sun zenith angle of VI pixel"       "Relative azimuth angle of VI pixel"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "Day of year of VI pixel"            "Quality reliability of VI pixel"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quality_bandnames</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "QA_qual"     "QA_usef"     "QA_aer"      "QA_adj_cld"  "QA_BRDF"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "QA_mix_cld"  "QA_land_wat" "QA_snow_ice" "QA_shd"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quality_fullnames</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "VI Quality"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "VI usefulness"                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "Aerosol quantity"                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "Adjacent cloud detected"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "Atmosphere BRDF correction performed"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "Mixed Clouds"                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "Land/Water Flag"                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] "Possible snow/ice"                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [9] "Possible shadow"                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $indexes_bandnames</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "SR"    "NDFI"  "NDII7" "SAVI" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $indexes_fullnames</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Simple Ratio (NIR/Red)"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "Flood Index (Red-SWIR2)/(Red+SWIR2)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "NDII7 (NIR-SWIR2)/(NIR+SWIR2)"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "SAVI (NIR-Red)/(NIR+Red+0.5)*(1+0.5)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">is_hdf4_supported</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">MODIStsp</span><span class="op">(</span></span></span>
<span class="r-in"><span>    gui <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    out_folder <span class="op">=</span> <span class="st">"$tempdir"</span>,</span></span>
<span class="r-in"><span>    selprod <span class="op">=</span> <span class="st">"Vegetation_Indexes_16Days_1Km (M*D13A2)"</span>,</span></span>
<span class="r-in"><span>    bandsel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EVI"</span>, <span class="st">"NDVI"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    quality_bandsel <span class="op">=</span> <span class="st">"QA_usef"</span>,</span></span>
<span class="r-in"><span>    indexes_bandsel <span class="op">=</span> <span class="st">"SR"</span>,</span></span>
<span class="r-in"><span>    user <span class="op">=</span> <span class="st">"mstp_test"</span> ,</span></span>
<span class="r-in"><span>    password <span class="op">=</span> <span class="st">"MSTP_test_01"</span>,</span></span>
<span class="r-in"><span>    start_date <span class="op">=</span> <span class="st">"2020.06.01"</span>,</span></span>
<span class="r-in"><span>    end_date <span class="op">=</span> <span class="st">"2020.06.15"</span>,</span></span>
<span class="r-in"><span>    verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    parallel <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Please note that rgdal will be retired during October 2023,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> plan transition to sf/stars/terra functions using GDAL and PROJ</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> at your earliest convenience.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> See https://r-spatial.org/r/2023/05/15/evolution4.html and https://github.com/r-spatial/evolution</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> rgdal: version: 1.6-7, (SVN revision 1203)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Geospatial Data Abstraction Library extensions to R successfully loaded</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loaded GDAL runtime: GDAL 3.6.2, released 2023/01/02</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Path to GDAL shared files: C:/Users/luigi.ranghetti/AppData/Local/Programs/R/R-4.3.0/library/rgdal/gdal</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  GDAL does not use iconv for recoding strings.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> GDAL binary built with GEOS: TRUE </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loaded PROJ runtime: Rel. 9.2.0, March 1st, 2023, [PJ_VERSION: 920]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Path to PROJ shared files: C:/Users/luigi.ranghetti/AppData/Local/Programs/R/R-4.3.0/library/rgdal/proj</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PROJ CDN enabled: FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Linking to sp version:1.6-1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> To mute warnings of possible GDAL/OSR exportToProj4() degradation,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> use options("rgdal_show_exportToProj4_warnings"="none") before loading sp or rgdal.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#' # - Running the tool using the settings previously saved in a specific options file</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># **NOTE** Output files of examples are saved to file.path(tempdir(), "MODIStsp").</span></span></span>
<span class="r-in"><span><span class="co"># You can run the examples with `gui = TRUE` to set a different output folder!</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Here we use a test json file saved in MODIStsp installation folder which</span></span></span>
<span class="r-in"><span><span class="co"># downloads and processed 3 MOD13A2 images over the Como Lake (Lombardy, Italy)</span></span></span>
<span class="r-in"><span><span class="co"># and retrieves NDVI and EVI data, plus the Usefulness Index Quality Indicator.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">opts_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testdata/test_MOD13A2.json"</span>, package <span class="op">=</span> <span class="st">"MODIStsp"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">is_hdf4_supported</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">MODIStsp</span><span class="op">(</span>gui <span class="op">=</span> <span class="cn">FALSE</span>, opts_file <span class="op">=</span> <span class="va">opts_file</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> GDAL version in use: 3.6.2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:50:59 2023] MODIStsp --&gt; Starting processing</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:50:59 2023] Accessing http server at:  https://e4ftl01.cr.usgs.gov/MOLT/MOD13A2.006/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:00 2023] Retrieving list of available ` Terra ` Files for Year 2016</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:02 2023] Downloading Terra Files for date: 2016_06_09 : 1 of:  1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:18 2023] [Mon Jun 12 09:51:18 2023] 1 files for date: 2016.06.09 were successfully downloaded!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:18 2023] Processing Terra NDVI files for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:19 2023] Processing Terra EVI files for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:19 2023] Processing Terra VI_QA files for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:19 2023] Computing QA_usef for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:22 2023] Downloading Terra Files for date: 2016_06_25 : 1 of:  1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:30 2023] [Mon Jun 12 09:51:30 2023] 1 files for date: 2016.06.25 were successfully downloaded!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:30 2023] Processing Terra NDVI files for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:30 2023] Processing Terra EVI files for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:31 2023] Processing Terra VI_QA files for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:31 2023] Computing QA_usef for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:31 2023] Creating Virtual Files and R time series for layer NDVI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:31 2023] Creating Virtual Files and R time series for layer EVI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:31 2023] Creating Virtual Files and R time series for layer QA_usef</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:31 2023] Total Processing Time: 32.8020129203796</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:31 2023] MODIStsp processed files are in: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:31 2023] Original downloaded MODIS HDF files are in: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp/HDFs`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:31 2023] Processing options saved to: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp/MODIStsp_2023-06-12.json`</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Running the tool using the settings previously saved in a specific option file</span></span></span>
<span class="r-in"><span><span class="co"># and specifying the extent from a spatial file allows to re-use the same</span></span></span>
<span class="r-in"><span><span class="co"># processing settings to perform download and reprocessing on a different area</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">opts_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testdata/test_MOD13A2.json"</span>, package <span class="op">=</span> <span class="st">"MODIStsp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spatial_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testdata/lakeshapes/garda_lake.shp"</span>, package <span class="op">=</span> <span class="st">"MODIStsp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">is_hdf4_supported</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">MODIStsp</span><span class="op">(</span></span></span>
<span class="r-in"><span>    gui <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    opts_file <span class="op">=</span> <span class="va">opts_file</span>,</span></span>
<span class="r-in"><span>    spatmeth <span class="op">=</span> <span class="st">"file"</span>,</span></span>
<span class="r-in"><span>    spafile <span class="op">=</span> <span class="va">spatial_file</span>,</span></span>
<span class="r-in"><span>    verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    parallel <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> GDAL version in use: 3.6.2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:32 2023] MODIStsp --&gt; Starting processing</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:32 2023] Accessing http server at:  https://e4ftl01.cr.usgs.gov/MOLT/MOD13A2.006/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:33 2023] Retrieving list of available ` Terra ` Files for Year 2016</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:35 2023] HDF File: MOD13A2.A2016161.h18v04.006.2016184001910.hdf already exists on your system. Skipping download!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:35 2023] [Mon Jun 12 09:51:35 2023] 1 files for date: 2016.06.09 were successfully downloaded!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:35 2023] Processing Terra NDVI files for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:35 2023] Processing Terra EVI files for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:36 2023] Processing Terra VI_QA files for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:36 2023] Computing QA_usef for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:38 2023] HDF File: MOD13A2.A2016177.h18v04.006.2016200095913.hdf already exists on your system. Skipping download!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:38 2023] [Mon Jun 12 09:51:38 2023] 1 files for date: 2016.06.25 were successfully downloaded!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:38 2023] Processing Terra NDVI files for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:39 2023] Processing Terra EVI files for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:39 2023] Processing Terra VI_QA files for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:39 2023] Computing QA_usef for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:40 2023] Creating Virtual Files and R time series for layer NDVI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:40 2023] Creating Virtual Files and R time series for layer EVI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:40 2023] Creating Virtual Files and R time series for layer QA_usef</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:40 2023] Total Processing Time: 8.28673696517944</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:40 2023] MODIStsp processed files are in: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp/garda_lake`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:40 2023] Original downloaded MODIS HDF files are in: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp/HDFs`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:40 2023] Processing options saved to: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp/garda_lake/MODIStsp_2023-06-12.json`</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Running the tool using the settings previously saved in a</span></span></span>
<span class="r-in"><span><span class="co"># specific options file and specifying each time the extent from a different</span></span></span>
<span class="r-in"><span><span class="co"># spatial file (e.g., to perform the same processing on several extents)</span></span></span>
<span class="r-in"><span><span class="co"># Note that you can also put all your extent files in a specific folder and</span></span></span>
<span class="r-in"><span><span class="co"># create the extent list using for example.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">extent_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testdata/lakeshapes/"</span>, package <span class="op">=</span> <span class="st">"MODIStsp"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"\\.shp$"</span>,</span></span>
<span class="r-in"><span>  full.names <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">extent_list</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "C:/Users/luigi.ranghetti/AppData/Local/Temp/Rtmp2h2J93/temp_libpath4798396c1738/MODIStsp/testdata/lakeshapes/garda_lake.shp"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "C:/Users/luigi.ranghetti/AppData/Local/Temp/Rtmp2h2J93/temp_libpath4798396c1738/MODIStsp/testdata/lakeshapes/iseo_lake.shp" </span>
<span class="r-in"><span><span class="va">opts_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testdata/test_MOD13A2.json"</span>, package <span class="op">=</span> <span class="st">"MODIStsp"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">is_hdf4_supported</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">single_shape</span> <span class="kw">in</span> <span class="va">extent_list</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">MODIStsp</span><span class="op">(</span></span></span>
<span class="r-in"><span>      gui <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>      opts_file <span class="op">=</span> <span class="va">opts_file</span>,</span></span>
<span class="r-in"><span>      spatmeth <span class="op">=</span> <span class="st">"file"</span>,</span></span>
<span class="r-in"><span>      spafile <span class="op">=</span> <span class="va">single_shape</span>,</span></span>
<span class="r-in"><span>      verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      parallel <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> GDAL version in use: 3.6.2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:40 2023] MODIStsp --&gt; Starting processing</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:40 2023] Accessing http server at:  https://e4ftl01.cr.usgs.gov/MOLT/MOD13A2.006/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] Retrieving list of available ` Terra ` Files for Year 2016</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] [Mon Jun 12 09:51:41 2023] All Required output files for date 2016_06_09 are already existing - Doing Nothing!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Set Reprocess to TRUE to reprocess existing data!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] [Mon Jun 12 09:51:41 2023] All Required output files for date 2016_06_25 are already existing - Doing Nothing!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Set Reprocess to TRUE to reprocess existing data!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] Creating Virtual Files and R time series for layer NDVI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] Creating Virtual Files and R time series for layer EVI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] Creating Virtual Files and R time series for layer QA_usef</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] Total Processing Time: 1.21842813491821</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] MODIStsp processed files are in: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp/garda_lake`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] Original downloaded MODIS HDF files are in: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp/HDFs`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] Processing options saved to: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp/garda_lake/MODIStsp_2023-06-12.json`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> GDAL version in use: 3.6.2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] MODIStsp --&gt; Starting processing</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:41 2023] Accessing http server at:  https://e4ftl01.cr.usgs.gov/MOLT/MOD13A2.006/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:42 2023] Retrieving list of available ` Terra ` Files for Year 2016</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:44 2023] HDF File: MOD13A2.A2016161.h18v04.006.2016184001910.hdf already exists on your system. Skipping download!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:44 2023] [Mon Jun 12 09:51:44 2023] 1 files for date: 2016.06.09 were successfully downloaded!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:44 2023] Processing Terra NDVI files for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:45 2023] Processing Terra EVI files for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:45 2023] Processing Terra VI_QA files for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:46 2023] Computing QA_usef for date: 2016_06_09</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:48 2023] HDF File: MOD13A2.A2016177.h18v04.006.2016200095913.hdf already exists on your system. Skipping download!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:48 2023] [Mon Jun 12 09:51:48 2023] 1 files for date: 2016.06.25 were successfully downloaded!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:48 2023] Processing Terra NDVI files for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:48 2023] Processing Terra EVI files for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:49 2023] Processing Terra VI_QA files for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:49 2023] Computing QA_usef for date: 2016_06_25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:49 2023] Creating Virtual Files and R time series for layer NDVI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:49 2023] Creating Virtual Files and R time series for layer EVI</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:49 2023] Creating Virtual Files and R time series for layer QA_usef</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:49 2023] Total Processing Time: 7.7650249004364</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:49 2023] MODIStsp processed files are in: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp/iseo_lake`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:49 2023] Original downloaded MODIS HDF files are in: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp/HDFs`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [Mon Jun 12 09:51:49 2023] Processing options saved to: `C:\Users\LUIGI~1.RAN\AppData\Local\Temp\Rtmp0GZyp1/MODIStsp/iseo_lake/MODIStsp_2023-06-12.json`</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># output files are placed in separate folders:</span></span></span>
<span class="r-in"><span><span class="va">outfiles_garda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"MODIStsp/garda_lake/VI_16Days_1Km_v6/NDVI"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  full.names <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outfiles_garda</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "C:\\Users\\LUIGI~1.RAN\\AppData\\Local\\Temp\\Rtmp0GZyp1/MODIStsp/garda_lake/VI_16Days_1Km_v6/NDVI/MOD13A2_NDVI_2016_161.tif"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "C:\\Users\\LUIGI~1.RAN\\AppData\\Local\\Temp\\Rtmp0GZyp1/MODIStsp/garda_lake/VI_16Days_1Km_v6/NDVI/MOD13A2_NDVI_2016_177.tif"</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: raster</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: sp</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">outfiles_garda</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">outfiles_garda</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="MODIStsp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">outfiles_iseo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"MODIStsp/iseo_lake/VI_16Days_1Km_v6/NDVI"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  full.names <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outfiles_iseo</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "C:\\Users\\LUIGI~1.RAN\\AppData\\Local\\Temp\\Rtmp0GZyp1/MODIStsp/iseo_lake/VI_16Days_1Km_v6/NDVI/MOD13A2_NDVI_2016_161.tif"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "C:\\Users\\LUIGI~1.RAN\\AppData\\Local\\Temp\\Rtmp0GZyp1/MODIStsp/iseo_lake/VI_16Days_1Km_v6/NDVI/MOD13A2_NDVI_2016_177.tif"</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">outfiles_garda</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">outfiles_iseo</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="MODIStsp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># See also https://docs.ropensci.org/MODIStsp/articles/noninteractive_execution.html</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lorenzo Busetto, Luigi Ranghetti.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

